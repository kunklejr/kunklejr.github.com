
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Jeff Kunkle's Blog</title>
  <meta name="author" content="Jeff Kunkle">

  
  <meta name="description" content="While I was reading through some Apple documentation on Bonjour I stumbled across a discussion on link-local addressing and DNS search domains. While &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://kunkle.org/blog/page/3/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Jeff Kunkle's Blog" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-37321329-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Jeff Kunkle's Blog</a></h1>
  
    <h2>a blog about software and related stuff</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:kunkle.org" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/talks">Talks</a></li>
  <li><a href="https://github.com/kunklejr">Code</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/01/24/use-dns-search-domains-for-sho/">Use DNS Search Domains for Shorter URLs</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-01-24T20:01:37-05:00" pubdate data-updated="true">Jan 24<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>While I was reading through some Apple documentation on Bonjour I stumbled across a discussion on link-local addressing and DNS search domains. While the details of link-local addressing aren&#8217;t that important here, the discussion on DNS search domains triggered a little light bulb in my brain.</p>

<p>You see, DNS search domains are used as a guide to help your computer lookup an IP address when something simple like &#8220;blogs&#8221; is typed into your browser&#8217;s URL. If you setup a DNS search domain of &#8220;nearinfinity.com&#8221;, typing &#8220;blogs&#8221; will force your computer to first check if there&#8217;s an address for &#8220;blogs.nearinfinity.com&#8221;. If not it falls back to its default behavior.</p>

<p>If you&#8217;re a person that spends a lot of time on a small number of websites, you could use DNS search domains to your advantage to make navigating to those sites a snap. For instance, I just setup &#8220;nearinfinity.com&#8221; as an entry in my DNS search domains on my Mac. Simply go to the network preferences pane, click the advanced button at the bottom left, and then the DNS tab on the resulting popup.</p>

<p><img src="/assets/dns_search_domains_osx.jpg" title="DNS Search Domain" alt="dnssearch" /></p>

<p>So now, whenever I type &#8220;blogs&#8221; in my URL I get &#8220;blogs.nearinfinity.com&#8221;. Whenever I type &#8220;support&#8221; I get &#8220;support.nearinfinity.com&#8221;. I think you probably get the idea. I know I&#8217;m no genius for discovering this since it&#8217;s precisely the reason for having search domains. I just never thought to use them before.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2007/12/31/use-caution-when-mixing-junit/">Use Caution When Mixing JUnit 3 and 4</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-12-31T07:30:00-05:00" pubdate data-updated="true">Dec 31<span>st</span>, 2007</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Quick quiz, what is the output from the following JUnit test?</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">nearinfinity</span><span class="o">.</span><span class="na">sandbox</span><span class="o">;</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">junit.framework.TestCase</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'><span class="kn">import</span> <span class="nn">org.junit.After</span><span class="o">;</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">org.junit.Before</span><span class="o">;</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">org.junit.Test</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ModelTest</span> <span class="kd">extends</span> <span class="n">TestCase</span> <span class="o">{</span>
</span><span class='line'>
</span><span class='line'>    <span class="nd">@Before</span>
</span><span class='line'>    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setUp</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Setup called.&quot;</span><span class="o">);</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="nd">@After</span>
</span><span class='line'>    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">teardown</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Teardown called.&quot;</span><span class="o">);</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="nd">@Test</span>
</span><span class='line'>    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testSomething</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>        <span class="n">assertTrue</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>

<p>If you said</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="n">Setup</span> <span class="n">has</span> <span class="n">been</span> <span class="n">called</span><span class="o">.</span>
</span><span class='line'><span class="n">Teardown</span> <span class="n">has</span> <span class="n">been</span> <span class="n">called</span><span class="o">.</span>
</span></code></pre></td></tr></table></div></figure>

<p>you&#8217;d be wrong. Don&#8217;t feel bad though, I spent about two hours staring at a similar test until I finally figured out what was going on. So, what&#8217;s the problem?</p>

<p>The problem lies in the mixed use of JUnit 3 and 4 concepts. The astute reader will notice that this test extends the JUnit 3 <em>junit.framework.TestCase</em> while also using JUnit 4 annotations. So which wins, the base class methods, the annotations, or both? Well, it turns out that the JUnit 3 base class conventions win out and the annotations are ignored. With that said, can you now guess what the test output is? Did you guess</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="go">Setup has been called.</span>
</span></code></pre></td></tr></table></div></figure>

<p>If not, don&#8217;t feel bad. It&#8217;s not immediately obvious. It turns out that the <em>testSomething</em> test method runs because it starts with the word <em>test</em>, not because it&#8217;s decorated with the <em>org.junit.Test</em> annotation. The <em>setUp</em> method runs because it overrides <em>junit.framework.TestCase</em>&#8217;s <em>setUp</em> method, not because it has a <em>org.junit.Before</em> annotation. Lastly, the <em>teardown</em> method doesn&#8217;t run at all because it does not override the base class <em>tearDown</em> method due to the lowercase &#8220;d&#8221; and as we&#8217;ve seen, the <em>org.junit.After</em> annotation has no effect.</p>

<p>That lower case &#8220;d&#8221; cost me two hours of my life, which I now consider time well spent. It made me realize that my test&#8217;s inheritance chain ultimately led to <em>junit.framework.TestCase</em>. The fact that the test had worked in the past was a textbook case of dumb luck.</p>

<p>So, if your JUnit 4 test classes start acting strange, make sure that base class you&#8217;re extending doesn&#8217;t ultimately lead to a <em>junit.framework.TestCase</em>. </p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2007/11/26/application-versus-database-security/">Application Versus Database Security</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-11-26T07:30:00-05:00" pubdate data-updated="true">Nov 26<span>th</span>, 2007</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>
The merits of placing security in the application layer versus the database is a debate I seem to find myself in regularly. As an application developer, I&#8217;ve historically argued for application-level security. It was something I understood well and felt like I had some control over. Over time, I&#8217;ve come to understand the debate from many perspectives and have adjusted my convictions accordingly.
</p>
<p>
For the record, I don&#8217;t believe there is any absolutely correct answer. There are valid arguments for each side of the debate. My perspective has mostly been shaped through experience developing custom software for clients. I have little experience developing commercial software and surmise that your thoughts on the subject may differ if that&#8217;s your day job.
</p>
<p>
In my experience, most customers view their data as the most important aspect of any system, not the application. They want to be sure their data is safe at all times. What if someone accesses the database through a different application, a third-party data broker or directly via a SQL client? How do you protect the data in those situations if all the restrictions are resident in the application? I hear these questions all the time.
</p>
<p>
The rebuttal to this argument that I hear most often is that nobody will ever access the data outside of the application. This seems like an obviously shortsighted statement to me and I don&#8217;t think anyone actually believes it. It&#8217;s more of a synonym for saying that you&#8217;d rather not worry about security at the database layer because it&#8217;s out of your control, too hard, etc. Pick your favorite excuse. I&#8217;ve probably used them all myself.
</p>
<p>
What it all boils down to is that the database is very likely to outlive your application. In fact, it&#8217;ll probably outlive your application and several subsequent ones. Why would a customer want to pay someone to rebuild the security logic each time? It&#8217;s tedious, expensive, and error prone. Additionally, you&#8217;re application may not be the only one accessing the database. What are the odds that two development teams implement security constraints the same exact way in each application? Not good, I promise.
</p>
<p>
As I stated in the beginning, I&#8217;ve definitely changed my perspectives on application versus database-level security. I was certainly an application-level security bigot before, but I find it difficult to continue my unwavering ways when looking at the problem more critically. I just hope my fellow colleagues don&#8217;t renounce me for siding with the DBAs on this one.
</p> 
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2007/08/15/review-of-the-definitive-guide/">Review of the Definitive Guide to Grails</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-08-15T09:11:01-04:00" pubdate data-updated="true">Aug 15<span>th</span>, 2007</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div style="float:left; margin:5px"><a href="http://www.amazon.com/gp/product/1590597583?ie=UTF8&amp;tag=jefkun-20&amp;linkCode=as2&amp;camp=1789&amp;creative=9325&amp;creativeASIN=1590597583"><img border="0" src="/assets/definitive_guide_to_grails_cover.jpg" /></a><img src="http://www.assoc-amazon.com/e/ir?t=jefkun-20&amp;l=as2&amp;o=1&amp;a=1590597583" width="1" height=";1&quot;" border="0" alt="" style="border:none !important; margin:0px !important;" /></div>

<p>I&#8217;ve found myself a bit bored with web application development lately. I&#8217;ve been itching to do something significant with <a href="http://www.rubyonrails.org">Ruby on Rails</a> for quite some time but always find myself working on Java projects for various clients. At the recommendation of some colleagues I&#8217;ve decided to take a peak at Grails and I have to say that I&#8217;ve shed my boredom and am once again excited about web development.</p>

<p>The following is my review of <a href="http://www.amazon.com/gp/redirect.html?ie=UTF8&amp;location=http%3A%2F%2Fwww.amazon.com%2FDefinitive-Guide-Grails%2Fdp%2F1590597583%3Fie%3DUTF8%26s%3Dbooks%26qid%3D1187180584%26sr%3D8-1&amp;tag=jefkun-20&amp;linkCode=ur2&amp;camp=1789&amp;creative=9325">The Definitive Guide to Grails</a>, written by Graeme Keith Rocher. Prior to reading this book I considered myself to know a lot about Java, a little about Ruby and Ruby on Rails, very little about <a href="http://groovy.codehaus.org/">Groovy</a>, and nothing about <a href="http://grails.codehaus.org/">Grails</a>. After one speed reading of The Definitive Guide to Grails I have to admit that I&#8217;m quite excited at the prospect of starting a new project with Grails.</p>

<h1 id="conclusion">Conclusion</h1>

<p>Yes, that&#8217;s right, I&#8217;m placing the conclusion at the front of the review. Why? Because the reviews of each chapter ended up being much longer than I&#8217;d anticipated and I fear few readers will hang on until the end. If you&#8217;re interested in some of the finer grained details of each chapter please read the following sections that I spent way too much time writing.</p>

<p>I found The Definitive Guide to Grails to be one of the best technical books I&#8217;ve read recently. The book appears to be targeted at the Grails newbie, which would suit just about everyone at this point in time. I never felt the content was over my head nor was I bored with long-winded explanations. I was looking for a book that would introduce me to as many core Grails concepts as possible within a short page count, and Graeme&#8217;s book certainly delivered.</p>

<p>If you learn best by following along with examples, you&#8217;re likely to enjoy this book. All eleven chapters are filled with plenty of code examples that not only bolstered my understanding of Grails, but also helped me comprehend some of the finer points of the Groovy language. I found the examples to be straightforward, numerous, and relatively short. I&#8217;m not a big fan of the long multi-page examples you sometimes find in technical books. I want enough just enough code to understand the topic and then move on. In my opinion, this is where The Definitive Guide to Grails excels. If you&#8217;re coming from a Java background, you should be able to pick up on the examples with minimal effort.</p>

<p>Also being new to Groovy, I appreciated the fact that Graeme sprinkled the use of some advanced Groovy features into the code examples. In wasn&#8217;t a windfall of features mind you, but it was enough to convince me of the power of Groovy and get me excited about learning more.</p>

<p>Overall, The Definitive Guide to Grails was a well-written, informative treatment of an exciting new web development framework. The code examples were woven in very well and really helped to understand the topics. If you&#8217;re looking to get up to speed on Grails in short order, I think you&#8217;ll be pleased with <a href="http://www.amazon.com/gp/redirect.html?ie=UTF8&amp;location=http%3A%2F%2Fwww.amazon.com%2FDefinitive-Guide-Grails%2Fdp%2F1590597583%3Fie%3DUTF8%26s%3Dbooks%26qid%3D1187180584%26sr%3D8-1&amp;tag=jefkun-20&amp;linkCode=ur2&amp;camp=1789;amp;creative=9325">The Definitive Guide to Grails</a>.</p>

<p>The following paragraphs provide a quick summary of each chapter.</p>

<h1 id="chapter_1_the_search_for_the_holy_grails">Chapter 1 - The Search for the Holy Grail(s)</h1>

<p>The first chapter provides some insight into the how and why of Grails. Graeme hits on the relative difficulty of developing applications on the JEE platform. He goes on to discuss how the prominence of Ajax and Web 2.0 have focused a lot of attention on web application development, and more specifically efficient web app development.</p>

<p>He then moves onto an introduction of Grails, paying homage to its Ruby on Rails inspiration. There&#8217;s a short discussion of how Grails leverages the power of the Java platform and specifically the <a href="http://www.springframework.org">Spring Framework</a>, <a href="http://www.hibernate.org">Hibernate</a>, and <a href="http://www.opensymphony.com/sitemesh/">Sitemesh</a>. </p>

<p>The remainder of the chapter gets you up and running with Groovy and Grails. Graeme guides you though creating the first pieces of the sample application used throughout the book. Very few concepts are explained at this point, but it does whet the pallet.</p>

<h1 id="chapter_2_the_groovy_language">Chapter 2 - The Groovy Language</h1>

<p>Here&#8217;s your introduction to the Groovy language from the perspective of a Java developer. The basic topics introduced include classes, assertions, Groovy Strings (GStrings), closures, lists, maps, and Expando objects. Graeme follows up with some &#8220;power&#8221; features such as Groovy&#8217;s object-oriented design, Groovy&#8217;s notion of equals, metaprogramming, and builders.</p>

<p>You shouldn&#8217;t expect to become an expert on Groovy from this one chapter. For that, consider reading <a href="http://www.amazon.com/gp/redirect.html?ie=UTF8&amp;location=http%3A%2F%2Fwww.amazon.com%2FGroovy-Action-Dierk-Koenig%2Fdp%2F1932394842%3Fie%3DUTF8%26s%3Dbooks%26s9r%3D8afd079f0eefbbe9010f873c3e10073b%26itemPosition%3D1%26qid%3D1187180781%26sr%3D1-1&amp;tag=jefkun-20&amp;linkCode=ur2&amp;camp=1789&amp;creative=9325">Groovy in Action</a> or <a href="http://www.amazon.com/gp/redirect.html?ie=UTF8&amp;location=http%3A%2F%2Fwww.amazon.com%2FGroovy-Programming-Introduction-Java-Developers%2Fdp%2F0123725070%3Fie%3DUTF8%26s%3Dbooks%26qid%3D1187180781%26sr%3D1-3&amp;tag=jefkun-20&amp;linkCode=ur2&amp;camp=1789&amp;creative=9325">Groovy Programming: An Introduction for Java Developers</a>. Luckily, I found most of the topics to be explained in enough detail for me to follow along. A Java or Ruby background is a big help here. Without it, I think you may have a difficult time understanding some of the code samples.</p>

<h1 id="chapter_3_the_grails_project_infrastructure">Chapter 3 - The Grails Project Infrastructure</h1>

<p>This chapter dives into how a Grails project is organized and configured. If you&#8217;ve ever used Ruby on Rails, you&#8217;ll notice the project directory structure is similar. Either way, the big benefit here is that there&#8217;s a common structure for all Grails projects.</p>

<p>Graeme follows up the directory structure discussion with a brief description of Grails and the MVC architecture. At first I groaned about having to read yet another description of MVC, but it turns out that I didn&#8217;t have to. The whole discussion is only two pages covering where the different Grails components like controllers, views, and the domain model fit into the MVC picture.</p>

<p>The next few pages focus on configuring your data source and logging configuration for different environments. While I welcome the configuration simplicity Grails provides for these resources, I found myself wondering how I would specify other things on an environment by environment level.</p>

<p>The Grails command line utilities, console, and shell are also introduced in chapter three. The command line utilities are very Rails-like, providing you with quick scripts to create things such as applications, controllers, domain objects, tests and tag libraries. The command line can also be used to launch the Grails shell and console. Graeme doesn&#8217;t spend much time explaining these commands, nor do I think he needs to. Just being aware of them is probably good enough since they&#8217;re mostly self-explanatory.</p>

<p>The chapter finishes up with a discussion on Eclipse IDE integration. Graeme spends a good six pages describing the integration with plenty of screen shots to guide the reader along. I can&#8217;t comment on how good the instructions actually are since I didn&#8217;t try them.</p>

<h1 id="chapter_4_the_application_domain">Chapter 4 - The Application Domain</h1>

<p>This is the chapter where you really see Grails shine. It&#8217;s a long chapter mainly covering Grails ORM (GORM) and domain model validation. I felt that Graeme spent a lot of time explaining these two concepts and it really paid off for me. </p>

<h2 id="grails_orm_gorm">Grails ORM (GORM)</h2>

<p>On the GORM side, he covers the basics of creating Grails domain objects and setting up relationships between them. He then goes on to talk about the various ways to query the database, including dynamic finders and a lengthy discussion on how to leverage the Hibernate Criteria API. The text on using the Hibernate Criteria made it seem relatively trivial to take advantage of the powerful library.</p>

<p>One thing I found strangely missing was a description of how to create the database schema. There were plenty of examples describing how to create the domain model, establish associations, and perform queries, but no description of how to create the necessary tables in the first place. I assume Grails is relying on Hibernate to automatically create the schema, but this is purely a guess since it&#8217;s not touched upon.</p>

<h2 id="data_validation">Data Validation</h2>

<p>The discussion on domain model validation focuses on how to add simple constraints to individual fields of your domain model. Graeme also describes how to create custom constraints through the use of closures.</p>

<h1 id="chapter_5_scaffolding">Chapter 5 - Scaffolding</h1>

<p>Chapter five included a discussion of both dynamic and static scaffolding. Unfortunately (in my opinion), Graeme devotes three-quarters of the chapter to dynamic scaffolding, which I&#8217;ve found to be of little benefit in my brief time playing with the Ruby on Rails equivalent. </p>

<h2 id="dynamic_scaffolding">Dynamic Scaffolding</h2>

<p>He uses dynamic scaffolding to create the first few pages of the sample application, showing the reader screen shots of the UI along the way. There are descriptions of how to modify some of the scaffolding by overriding default CRUD operations and customizing fields with constraints.</p>

<h2 id="static_scaffolding">Static Scaffolding</h2>

<p>I found the text on static scaffolding to be more beneficial. The discussion mainly focuses on using the command line tools to generate default implementations of controllers, views, tests, etc. There&#8217;s also some brief but clear discussion on the location of generated artifacts and the code that is created behind the scenes.</p>

<h1 id="chapter_6_testing_testing_testing">Chapter 6 - Testing, Testing, Testing</h1>

<p>The chapter on testing was split up into two sections, unit testing and functional testing. </p>

<h2 id="unit_testing">Unit Testing</h2>

<p>The unit testing part of the chapter covered Groovy&#8217;s assert methods beyond those provided by <a href="http://www.junit.org">JUnit</a> and its mocking capabilities through the use of closures. The generous code examples really helped me understand how powerful Groovy&#8217;s mocking capabilities are. My collegue Scott Leberknight has a <a href="http://www.nearinfinity.com/blogs/page/sleberkn?entry=dirt_simple_mocks_in_groovy">nice post</a> that explains some of the finer points of mocking with Groovy if you&#8217;re interested in some more detail.</p>

<h2 id="functional_testing">Functional Testing</h2>

<p>In my opinion, you can probably skip the second half of the chapter devoted to functional testing with <a href="http://webtest.canoo.com/webtest/manual/WebTestHome.html">Canoo WebTest</a>. Although Graeme does a nice job explaining how to use WebTest and its integration with Grails is commendable, I think it will largely be an exercise in frustration for any modern web application using Ajax. As far as I know, WebTest is not able to exercise any Ajax functionality.</p>

<h1 id="chapter_7_grails_controllers">Chapter 7 - Grails Controllers</h1>

<p>The chapter on Grails controllers covers a lot of ground in a short thirty-one pages, so make sure you&#8217;re paying close attention when you read it. There&#8217;s a lot of great information that you won&#8217;t want to miss. Below are some of the highlights.</p>

<h2 id="actions">Actions</h2>

<p>Graeme starts off by describing actions, the workhorses of controllers. He does a nice job of describing how Grails use of closures for action definitions is so beneficial. He quickly follows this up by describing how the developer can access various request attributes with little effort. For those of you who&#8217;ve written a lot of Java web applications in the past, you&#8217;ll be pleased to find that things like
    request.getSession().getAttribute(&#8220;attrName&#8221;)
are reduced to
    session.attrName</p>

<h2 id="flash">Flash</h2>

<p>The explanation of flash scope will be particularly helpful to anyone who hasn&#8217;t used Ruby on Rails before. Graeme does a nice job of illustrating how this scope differs from the familiar page, request, session, and servlet context scopes we&#8217;re all used to and why it&#8217;s so helpful to have it in your bag of tricks.  </p>

<h2 id="data_binding">Data Binding</h2>

<p>Three full pages are devoted to Grails data binding, which builds upon Spring&#8217;s binding code. Binding is one of the more tedious aspects of web development, but Graeme does a nice job at putting your worries at ease. He also takes the time to describe how binding can be used outside of the context of Grails domain objects.</p>

<h2 id="control_flow">Control Flow</h2>

<p>Graeme follows up data binding with some text on controlling flow with redirects. There&#8217;s nothing exciting here, although the tactics are well explained.</p>

<h2 id="response_rendering">Response Rendering</h2>

<p>Grails has a very flexible response rendering framework wrapped up in a simple API. The text covers a wide range of rendering options with short code samples. The discussion of rendering HTML or XML using builders is especially cool.</p>

<h2 id="action_interception">Action Interception</h2>

<p>Think of action interception as AOP for your controller methods, which is exactly how it&#8217;s described by the author. He gives a quick example of before and after advice followed by a discussion of how action interceptors can be used to implement authentication and authorization. The apparent simplicity of this approach makes me wonder if using Acegi (as briefly described in chapter eleven) is worth the effort.</p>

<h2 id="file_uploads">File Uploads</h2>

<p>The last topic in this busy chapter deals with file uploads, which again builds upon Spring&#8217;s binding technology. Graeme provides two examples of handling file uploads. The first involves pulling the file directly from the request from within a controller. The second example demonstrates binding a file directly to a domain model object.</p>

<h1 id="chapter_8_groovy_server_pages">Chapter 8 - Groovy Server Pages</h1>

<p>The chapter on Groovy Server Pages (GSP) is quite long and covers a lot of material. The chapter starts off by talking about some of the more mundane basics; page directives, scriptlets, and GStrings but quickly moves on to more interesting topics.</p>

<h2 id="tags">Tags</h2>

<p>Graeme starts off the tag discussion by describing the built-in Grails tags. There&#8217;s at least one usage example for setting variables with tags, logic tags, and iterative tags. These tags probably don&#8217;t sound all that different than the JSTL ones you may have used, and they aren&#8217;t. What is different are the filtering and iteration tags, including collect, findAll, and grep. For these more unfamiliar tags, Graeme provides several examples each that demonstrate their usage. He finishes off by talking about Grails dynamic tags, explaining both how to use the built-in Grails ones and also how to create your own.</p>

<h2 id="validation_and_error_handling">Validation and Error Handling</h2>

<p>Validation and error handling are next on tap. The discussion here is short and to the point. If you&#8217;ve had any experience with Spring MVC before, this text will be quite familiar.</p>

<h2 id="internationalization_support">Internationalization Support</h2>

<p>The discussion of internationalization support is very brief, but I didn&#8217;t find it lacking. You&#8217;re mileage may vary. It basically boils down to describing where different language bundles are placed in the Grails directory structure and how those messages can be displayed using Grails tags.</p>

<h2 id="layouts_and_templates">Layouts and Templates</h2>

<p>Graeme spends a full ten pages describing layouts and templates, more than I would have expected. He provides sample layouts and describes how layouts are selected by convention or through the use of meta tags. This is all the same stuff you&#8217;d expect if you&#8217;ve used SiteMesh before.</p>

<p>A discussion of templates follows the text on layouts. Templates are simply reusable snippets of markup. Graeme provides a few examples demonstrating how the g:render tag makes working with templates dead simple. If it weren&#8217;t for the g:render tag integration, templates would be little more than JSP includes.</p>

<h2 id="pagination">Pagination</h2>

<p>Pagination is one of those things that has to be dealt with in every web application, and it&#8217;s never fun. Here, Graeme explains how the g:paginate tag in Grails  makes rendering paging links and managing the display of multiple pages a bit easier. As usual, there are plenty of code examples to help you understand how to use the tag.</p>

<h2 id="custom_tags">Custom Tags</h2>

<p>Graeme finishes up the chapter with a discussion on how to create your own custom tags and yes, this is different than creating your own dynamic tags. Graeme describes the process through an example of in-place editing that&#8217;s folded into the example played out throughout the book. I found the example easy enough to understand but the resulting code ugly. It reminded me of the long forgotten days of outputting HTML from servlets.</p>

<h1 id="chapter_9_ajax">Chapter 9 - Ajax</h1>

<p>The chapter on Ajax is focused on describing the tight integration of Grails custom tags with your favorite JavaScript library, as long as it&#8217;s Prototype/Scriptaculous, Yahoo UI, or the Dojo Toolkit. Most of the explanation is described by refactoring the book example to add in some Ajax goodness. Included are descriptions of the g:remoteField, g:remoteLink, and g:formRemote tag, the process of specify JavaScript to run before or after a remote call, and custom event handling. Lastly, there&#8217;s a quick example of adding some JavaScript UI effects using Scriptaculous.</p>

<h1 id="chapter_10_services_and_jobs">Chapter 10 - Services and Jobs</h1>

<p>Chapter ten starts with a discussion of the traditional service tier of a Java application. This chapter is also home to the first mention of transactional support from Grails, and it is certainly brief. I have to think there&#8217;s a lot more to Grails transaction support than Graeme is divulging.</p>

<p>The discussion of services finishes up with a demonstration on the use of the service layer by creating one that calls a del.icio.us web service. The example covers everything from writing the Jakarta <a href="http://commons.apache.org/httpclient/">Commons HTTP Client</a> to calling the service from a controller.</p>

<p>From services we move to jobs, which Graeme has spent a whopping twenty-six pages describing. Jobs are built on top of the <a href="http://www.opensymphony.com/quartz/">Quartz</a> scheduling engine, and a good portion of the twenty-six pages is devoted to explaining it. He covers all angles associated with jobs, including creating, scheduling, testing, pausing, resuming, and removing jobs. All of this is done through a non-trivial example of a daily scheduled job that queries the database and then formats the results as an email delivered via JavaMail.</p>

<h1 id="chapter_11_java_integration">Chapter 11 - Java Integration</h1>

<p>The last chapter covers Grails integration with Java. The discussion is most heavily weighted towards integration options with Hibernate and Spring. However, Graeme also covers using <a href="http://www.acegisecurity.org/">Acegi</a> for Grails security and exposing a SOAP service using the <a href="http://xfire.codehaus.org/">XFire</a> library. The following paragraphs describe each topic.</p>

<h2 id="orm_integration_with_hibernate">ORM Integration with Hibernate</h2>

<p>Anyone using Hibernate on an existing project will likely be quite happy after reading this part of chapter eleven. Graeme describes how you can use Grails with an existing domain model and either Hibernate XML mapping files or EJB3 annotations. I have to admit that I had a bit of a smile on my face after reading this section and realizing that I didn&#8217;t have to wait for an entirely new project to try out Grails.</p>

<p>I was equally surprised to find that I can use Grails constraints on my non-Grails domain objects. Graeme provides an example of how to do this in short order.</p>

<h2 id="dependency_injection_with_spring">Dependency Injection with Spring</h2>

<p>The section on dependency injection with Spring shows you how to leverage the Spring Framework underlying Grails. A basic understanding of the Spring Framework will certainly help understand the text, although I don&#8217;t think it&#8217;s absolutely necessary.</p>

<p>In the chapter, Graeme talks about how to override Grails beans and how to use Spring controllers with Grails. The explanation of using Spring controllers is much more thorough than I would have expected, with plenty of sample code to help guide the reader.</p>

<h2 id="acegi">Acegi</h2>

<p>The section on using Acegi is jam packed with the XML code snippets you need for a basic configuration of the security framework. If you seriously plan to use Acegi, you&#8217;ll need to look elsewhere for more information. The eight pages of XML is hardly enough to understand what&#8217;s going on. </p>

<h2 id="exposing_a_soap_service_with_xfire">Exposing a SOAP Service with XFire</h2>

<p>I have a feeling that Apress pressured Graeme into including the chapter on web services with XFire. After all, any respectable book on web development needs to talk about web services. Right? The content was nothing more than a brush pass and had nothing to do with Grails. The text, although well-explained, would have fit just as nicely in any book on JEE web development.</p>

<style type="text/css">h1, h2 {text-align:left}</style> 
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2007/04/15/solid-state-encrypted-drives-the/">Solid State Encrypted Drives - the Next Big Thing?</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-04-15T21:10:11-04:00" pubdate data-updated="true">Apr 15<span>th</span>, 2007</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I&#8217;ve noticed two topics generating a lot of buzz in the storage world lately.</p>

<ol>
<li>Hardware-Encrypted Disk Drives</li>
<li>Solid State Disk Drives</li>
</ol>

<p>I believe the first topic is a direct result of the disclosure of scores of high-profile data breaches resulting from stolen computers. The highest profile instance occurred in May of 2006 when a U.S. Department of Veteran&#8217;s Affairs laptop containing the names, social security numbers, dates of birth, phone numbers, and addresses of 26.5 million American veterans was stolen. Unauthorized information disclosure has unfortunately become an all too common occurrence in today&#8217;s world.</p>

<p>In response, vendors such as Seagate have introduced <a href="http://www.eweek.com/article2/0,1759,1825740,00.asp">hardware-encrypted notebook hard drives</a> to counter the unintended loss of sensitive information when a computer is stolen. The idea is that data stored on the hard drive is encrypted at all times, rendering the information practically useless to thieves. The encryption is done in specialized hardware to reduce the performance impact associated with the extra computation. </p>

<p>The second topic is the result of a continued increase in flash-based memory capacity to the point where it can now be considered as an alternative to traditional hard drives. Both Samsung and Sandisk have <a href="http://www.eweek.com/article2/0,1759,2108422,00.asp">recently announced</a> 64GB (Samsung) and 32GB (Sandisk) products targeted for laptop usage. Since there are no moving parts, flash-based memory consumes much less power than the spinning platters of a traditional hard disk, which is obviously a big benefit for laptop users. As a side benefit, these flash-based memory &#8220;drives&#8221; are rumored to be anywhere from 4-10x faster than a traditional hard drive, which brings me to the main point of this post.</p>

<p>How long will it be until we see solid-state &#8220;drives&#8221; such as the ones from Samsung and Sandisk coupled with dedicated hardware-based encryption as demonstrated on the new Seagate drive? A considerable downside to full-disk encryption of traditional drives is the performance impact. Since the new flash-based drives are several times faster, why not bake in full-drive encryption now when nobody will notice it. What you&#8217;d end up with are flash-based drives that provide full-disk encryption and still outperform traditional drives. Waiting to add full-disk encryption to later versions of flash-based drives will only introduce the performance debate that faces today&#8217;s traditional drives, making the purchasing decision all that much more difficult. Why not avoid the confusion and help customers better secure their data in the process?</p> 
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2007/03/30/update-mac-osx-split-for/">Update Mac OSX Split for Pieces Larger Than 2GB and Greater</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-03-30T10:26:23-04:00" pubdate data-updated="true">Mar 30<span>th</span>, 2007</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Split is a very useful command-line utility for breaking large files into smaller pieces. Unfortunately, the version Apple ships with OSX 10.4 cannot split files into pieces 2GB or larger. Luckily, there is a newer version of split that you can compile and use instead of the Apple-supplied one.</p>

<p>There is a nice <a href="http://www.macosxhints.com/article.php?story=20061118222901111">article/post</a> over at macosxhints.com describing how to upgrade split. It&#8217;s really not very hard but I thought I&#8217;d write a script so people could upgrade with a minimum of effort.</p>

<p>The short script is shown below. Please note that it is currently hard-coded for version 1.21 of split. You may want to check and see if there is a newer version before running the script.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c">#!/bin/bash</span>
</span><span class='line'>curl -o split.c <span class="s2">&quot;http://cvsweb.netbsd.org/bsdweb.cgi/~checkout~/src/usr.bin/split/split.c?rev=1.21&amp;content-type=text/plain&quot;</span>
</span><span class='line'>perl -p -i -e <span class="s1">&#39;s/#include /#include \n#include /&#39;</span> split.c
</span><span class='line'>cc -Os -o split split.c
</span><span class='line'>sudo mv /usr/bin/split /usr/bin/split.apple
</span><span class='line'>sudo cp split /usr/bin/split
</span><span class='line'>sudo chmod ugo-w /usr/bin/split
</span><span class='line'>sudo chmod ugo+rx /usr/bin/split
</span><span class='line'>sudo chown root:wheel /usr/bin/split
</span><span class='line'><span class="nb">echo</span> <span class="s2">&quot;Upgrade Complete.&quot;</span>
</span></code></pre></td></tr></table></div></figure>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2007/03/24/logging-into-mac-os-x/">Logging Into Mac OS X Hidden Administrator Accounts</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-03-24T12:20:12-04:00" pubdate data-updated="true">Mar 24<span>th</span>, 2007</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Every once in a while I need to login to a hidden administrator account on my Mac. It&#8217;s a simple process after you invest lots of time trying to remember the key combination needed to expose the User Name and Password prompt instead of the usual graphical user account login prompt (which doesn&#8217;t show the hidden admin accounts of course). Many times I&#8217;ve searched all over the Internet to uncover the secret and never seem to find anything quickly, so I thought I&#8217;d document it here for future reference.</p>

<p>Let&#8217;s assume that you&#8217;re staring at the usual graphical login prompt. There&#8217;s a nice little picture to the left of each of your user accounts, but no way to enter a username. If you only have one user account on your Mac, you&#8217;re already being prompted for the password to that account. If this is the case, hit Esc.</p>

<p>Now you should only see a list of all the user accounts on your Mac, and should not see a password field. Press the down arrow key until you see a gray background behind one of your user accounts. It doesn&#8217;t matter which one.</p>

<p>Next, press Option-Enter. Your normal graphical login screen should now be replaced with two text entry fields, one for your User Name and one for your Password. Now you can enter the username and password of your hidden administrator account (or any account for that matter). That&#8217;s it.</p>

<p>Please note that I don&#8217;t know if the Option-Enter key combination does anything if you don&#8217;t have any hidden accounts. You&#8217;ll have to try it for yourself and see.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2007/03/14/performance-of-guarding-debug-log/">Performance of Guarding Debug Log Statements</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-03-14T20:37:14-04:00" pubdate data-updated="true">Mar 14<span>th</span>, 2007</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>A few days ago, some people in the office were debating the value of our time honored tradition of guarding debug log statements. If you&#8217;re not sure what I&#8217;m talking about, a short code sample should clear things up quickly.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="k">if</span> <span class="o">(</span><span class="n">log</span><span class="o">.</span><span class="na">isDebugEnabled</span><span class="o">())</span> <span class="o">{</span>
</span><span class='line'>  <span class="n">log</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">&quot;Log message number &quot;</span> <span class="o">+</span> <span class="mi">1</span><span class="o">);</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>

<p>It&#8217;s generally accepted that guarding your log statements with an if block will improve performance if your log statements involve some kind of string concatenation, such as the example above. But what kind of performance improvement are we really talking about here?</p>

<p>To determine the impact of this log guarding, I wrote a simple program that repeatedly calls log statements with three different logging implementations. See <a href="/assets/logguard.zip">attachment</a> for the actual code.</p>

<ol>
<li>UnguardedLogger.java has no if block guarding the log statement at all.</li>
<li>IfGuardedLogger.java has the traditional if block surrounding the log statement, just like the example above.</li>
<li>AspectGuardedLogger.java acts just like the UnguardedLogger except that it has an AspectJ aspect guarding it&#8217;s log statement. The idea here was to allow you to abandoned typing the if block guard while still enjoying its benefits.</li>
</ol>

<p>All three implementations were asked to log one million statements in three successive batches. Each log statement included a string concatenation of six components. Each batch ran the three implementations in a different order. The results of the test run are shown below.</p>

<table border="1" cellpadding="5">
<thead style="background-color: silver">
  <tr><th>Implementation</th><th>Test 1</th><th>Test 2</th><th>Test 3</th></tr>
</thead>
<tbody>
  <tr><td>UnguardedLogger</td><td>1341ms</td><td>1783ms</td><td>1345ms</td></tr>
  <tr><td>IfGuardedLogger</td><td>35ms</td><td>32ms</td><td>30ms</td></tr>
  <tr><td>AspectGuardedLogger</td><td>1343ms</td><td>1612ms</td><td>1364ms</td></tr>
</tbody>
</table>

<p>Broken down by average time per log statement, that&#8217;s</p>

<ul>
<li>UnguardedLogger - 1.49µs/statement</li>
<li>IfGuardedLogger - 0.03µs/statement</li>
<li>AspectGuardedLogger - 1.44µs/statement</li>
</ul>

<p>From these numbers, I&#8217;ve drawn two conclusions</p>

<ol>
<li>Guarding your log statements is a lot faster (in this case, 50x faster) than not guarding them at all or guarding them using an aspect. Even so, we&#8217;re still down in the microsecond range here. If you&#8217;re doing a lot of logging, you may notice a small improvement from guarding your log statements. Otherwise, you may not want to bother.</li>
<li>Guarding your log statements with an around aspect is really no better than not guarding them at all. I&#8217;m not familiar with the internals of AspectJ, but my hunch is that even an around aspect will have to do the log statement string concatenation so that it could potentially be exposed as context for an advice. Hence, it ends up being about the same as not guarding the log statements at all.</li>
</ol> 
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2006/11/29/start-with-something-new/">Start With Something New</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2006-11-29T21:25:36-05:00" pubdate data-updated="true">Nov 29<span>th</span>, 2006</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>To one extent or another, I&#8217;ve been involved with many projects whose goal was to replace an existing system while adding some new features. On the surface, these sound like rather straightforward efforts. After all, the existing system is the source for all your legacy system replacement requirements, right? Unfortunately, these projects often struggle and many are never deployed. Why? Because they don&#8217;t start with something new.</p>

<p>In my experience, legacy replacement projects first focus on supplanting the features of the old system rather than building new capabilities. In many cases, the legacy system was built over a period of years where new features were continually added and refined. However, new development efforts are rarely given years to write replacement software for the legacy system. The result is usually an initial version that doesn&#8217;t even provide the same capabilities as the old application and adds little or nothing new. Why would a busy user spend their valuable time to learn a new system that provides less functionality than what they have today? In many cases they don&#8217;t and the system is labeled a failure before it even gets rolling.</p>

<p>Why not start by building the new features first? Hook your users with new capabilities they don&#8217;t have today and slowly replace the legacy features until the existing system is no longer needed or used. As a side benefit, your users may decide they don&#8217;t need certain features of the legacy system anymore or that they should work differently based on their experiences with the new capabilities you&#8217;ve given them. At the end of the day, I think you&#8217;ll end up with a more successful application that better addresses users&#8217; current needs.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2006/07/11/notnull-hibernate-annotation-validation-problems/">NotNull Hibernate Annotation Validation Problems</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2006-07-11T08:59:58-04:00" pubdate data-updated="true">Jul 11<span>th</span>, 2006</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>
I recently decided to try out Hibernate&#8217;s annotation-based validation framework. It seems like a great solution for ensuring consistent validation of the domain model regardless of the presentation tier (web interface, web service, etc.). It very much reminds me of the declarative validation available within Rails model objects.
</p>
<p>
To make a long story short, things did not go as well as I had hoped using a Hibernate Core 3.2.0 CR2 and Hibernate Annotations 3.2.0 CR1 combination. I struggled for hours trying to figure out why I was getting a &#8220;not-null property references a null or transient value&#8221; error rather than a validation error when attempting to use the NotNull validation annotation. Eventually I discovered the problem was not that the NotNull validation wasn&#8217;t working properly, but that it wasn&#8217;t running at all.
</p>
<p>
In order for the annotation-based validation framework to execute, Hibernate Annotations provides a <code>ValidatePreInsertEventListener</code> and <code>ValidatePreUpdateEventListener</code> to fire the annotation validations prior to persisting any changes to the domain model. &#8220;Pre-insert&#8221; and &#8220;pre-update&#8221; events are fired after other events, in this case <code>SaveOrUpdateEvent</code>(s). By default, Hibernate uses the <code>DefaultSaveOrUpdateEventListener</code>, which is an extension of <code>AbstractSaveEventListener</code>. The <code>AbstractSaveEventListener</code> checks for null values corresponding to non-nullable database columns ( <code>AbstractSaveEventListener:284</code> ) before adding the insert or update events to the execution queue( <code>AbstractSaveEventListener:290</code> ) responsible for triggering pre-insert or pre-update event listeners. In case that didn&#8217;t make complete sense, the bottom line is the Hibernate Core checks entities against the null constraints of the database before the annotation-based validation framework has a chance to run.
</p>
<p>
Luckily, there is a workaround, although it feels like a bit of a hack. As I mentioned previously, the <code>DefaultSaveOrUpdateEventListener</code> gets a chance to run before any &#8220;pre-insert&#8221; or &#8220;pre-update&#8221; events so we can use that to our advantage. The following <code>SaveOrUpdateEventListener</code> simply extends the Hibernate Annotations-provided <code>ValidateEventListener</code> and calls the validation method on &#8220;save-update&#8221; events rather than &#8220;pre-insert&#8221; and &#8220;pre-update&#8221; events.
</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ValidationEventListener</span>
</span><span class='line'>    <span class="kd">extends</span> <span class="n">ValidateEventListener</span>
</span><span class='line'>    <span class="kd">implements</span> <span class="n">SaveOrUpdateEventListener</span> <span class="o">{</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onSaveOrUpdate</span><span class="o">(</span><span class="n">SaveOrUpdateEvent</span> <span class="n">event</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">HibernateException</span> <span class="o">{</span>
</span><span class='line'>    <span class="kd">final</span> <span class="n">SessionImplementor</span> <span class="n">source</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="na">getSession</span><span class="o">();</span>
</span><span class='line'>    <span class="kd">final</span> <span class="n">Object</span> <span class="n">object</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="na">getObject</span><span class="o">();</span>
</span><span class='line'>    <span class="k">if</span> <span class="o">(!</span><span class="n">source</span><span class="o">.</span><span class="na">getPersistenceContext</span><span class="o">().</span><span class="na">reassociateIfUninitializedProxy</span><span class="o">(</span><span class="n">object</span><span class="o">))</span> <span class="o">{</span>
</span><span class='line'>      <span class="c1">// only validate the entity if it has been changed</span>
</span><span class='line'>      <span class="kd">final</span> <span class="n">Object</span> <span class="n">entity</span> <span class="o">=</span>
</span><span class='line'>        <span class="n">source</span><span class="o">.</span><span class="na">getPersistenceContext</span><span class="o">().</span><span class="na">unproxyAndReassociate</span><span class="o">(</span><span class="n">object</span><span class="o">);</span>
</span><span class='line'>      <span class="kd">super</span><span class="o">.</span><span class="na">validate</span><span class="o">(</span><span class="n">entity</span><span class="o">,</span> <span class="n">event</span><span class="o">.</span><span class="na">getSession</span><span class="o">().</span><span class="na">getEntityMode</span><span class="o">());</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>

<p>
One extemely important thing to remember when using this workaround is that you must configure the <code>DefaultSaveOrUpdateEventListener</code> as the second &#8220;save-update&#8221; listener (following the <code>ValidationEventListener</code>) or your objects will never be persisted.
</p> 
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/4/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/2/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/07/10/pull-request-etiquette/">Pull Request Etiquette</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/08/28/nodejs-test-coverage-reporting-with-covershot/">NodeJS Test Coverage Reporting with CoverShot</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/08/14/tech-presentation-tip-3-mirror-displays/">Tech Presentation Tip 3 - Mirror Displays</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/08/06/tech-presentation-tip-2-no-apologies-or-caveats/">Tech Presentation Tip 2 - No Apologies or Caveats</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/07/26/tech-presentation-tip-1-avoid-screen-resolution-shock/">Tech Presentation Tip 1 - Avoid Screen Resolution Shock</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/kunklejr">@kunklejr</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'kunklejr',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("kunklejr", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/kunklejr" class="twitter-follow-button" data-show-count="false">Follow @kunklejr</a>
  
</section>



<section class="googleplus">
  <h1>
    <a href="https://plus.google.com/108076180146802069516?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>



  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Jeff Kunkle -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'jkunkle-blog';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
